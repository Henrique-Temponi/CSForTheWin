#INCLUDE <P16F628A.INC>		;ARQUIVO PADRÃO MICROCHIP PARA 16F628A
RADIX DEC
__CONFIG H'3F10'

	CBLOCK	0x20	;ENDEREÇO INICIAL DA MEMÓRIA DE USUÁRIO
	CONTADOR1
	CONTADOR2
	CONTADOR3
	TEMPO
	ALEATORIO
	ENDC			;FIM DO BLOCO DE MEMÓRIA		

#DEFINE	BOTAO	PORTA,2	;PORTA DO BOTÃO
					; 0 -> PRESSIONADO
					; 1 -> LIBERADO

#DEFINE	LED1	PORTB,0	;PORTA DO LED 0 -> APAGADO 1 -> ACESO
#DEFINE	LED2	PORTB,1	;PORTA DO LED 0 -> APAGADO 1 -> ACESO
#DEFINE	LED3	PORTB,2	;PORTA DO LED 0 -> APAGADO 1 -> ACESO
#DEFINE	LED4	PORTB,3	;PORTA DO LED 0 -> APAGADO 1 -> ACESO
#DEFINE	LED5	PORTB,4	;PORTA DO LED 0 -> APAGADO 1 -> ACESO
#DEFINE	LED6	PORTB,5 ;PORTA DO LED 0 -> APAGADO 1 -> ACESO

	ORG	0x00		;ENDEREÇO INICIAL DE PROCESSAMENTO
	GOTO	INICIO
	
INICIO
	CLRF	PORTA		;LIMPA O PORTA
	CLRF	PORTB		;LIMPA O PORTB
	BSF STATUS, RP0			;ALTERA PARA O BANCO 1
	MOVLW	B'00000100'
	MOVWF	TRISA		;DEFINE RA2 COMO ENTRADA E DEMAIS COMO SAÍDAS
	CLRF	TRISB		;DEFINE TODO O PORTB COMO SAÍDA
	CLRF	INTCON		;TODAS AS INTERRUPÇÕES DESLIGADAS	
	BCF STATUS, RP0 ;RETORNA PARA O BANCO 0
	MOVLW	B'00000111'
	MOVWF	CMCON		;DEFINE O MODO DO COMPARADOR ANALÓGICO

MAIN
	
	MOVLW 1
	MOVWF ALEATORIO
	GOTO GAME
	GOTO MAIN
	
	TIMEOUT
		
		MOVLW 6
		MOVWF CONTADOR1

		;BTFSC BOTAO
		;CALL BUTTONTIMEOUT
		
		ATRASO1
			MOVLW 37
			MOVWF CONTADOR2
				
				ATRASO2
					MOVLW 125
					MOVWF CONTADOR3
					NOP
					ATRASO3
						MOVLW 10
						MOVWF TEMPO
							
						ATRASOBUTAO							
							DECFSZ TEMPO
							GOTO ATRASOBUTAO

						BTFSS BOTAO
						GOTO PREWIN
						
						DECFSZ CONTADOR3
						GOTO ATRASO3
				
				DECFSZ CONTADOR2
				GOTO ATRASO2
		
		DECFSZ CONTADOR1
		GOTO ATRASO1

	RETURN 
	
	PREWIN
		BTFSC LED1
		GOTO FIM

		BTFSC LED4
		GOTO FIM

	GOTO ATRASO3

	FIM
		BSF LED1
		BSF LED2
		BSF LED3
		BSF LED4
		BSF LED5
		BSF LED6

		MOVLW 100
		MOVWF CONTADOR1
		
		ATRASO1F
			MOVLW 100
			MOVWF CONTADOR2
				
				ATRASO2F
					MOVLW 100
					MOVWF CONTADOR3
					ATRASO3F
						DECFSZ CONTADOR3
						GOTO ATRASO3F
				
				DECFSZ CONTADOR2
				GOTO ATRASO2F
		
		DECFSZ CONTADOR1
		GOTO ATRASO1F
		
		BCF LED1
		BCF LED2
		BCF LED3
		BCF LED4
		BCF LED5
		BCF LED6
	GOTO END1
	
	ONLED

		DECFSZ ALEATORIO
		RAND1
		DECFSZ ALEATORIO
		RAND2
		INCFSZ ALEATORIO
		RAND3
		DECFSZ ALEATORIO
		RAND4
		DECFSZ ALEATORIO
		RAND5
		INCFSZ ALEATORIO
		RAND6
		DECSZ ALEATORIO
		RAND7
		DECFSZ ALEATORIO
		RAND8
		INCFSZ ALEATORIO
		RAND9
		DECFSZ ALEATORIO
		RAND10
		
		
	RAND1
	
		DEC ALEATORIO
		DEC ALEATORIO
		DEC ALEATORIO
		BSF LED2
		CALL TIMEOUT
		BCF LED2
		CALL TIMEOUT
		
		BSF LED5
		CALL TIMEOUT
		BCF LED5
		CALL TIMEOUT
		
		BSF LED4
		CALL TIMEOUT
		BCF LED4	
		CALL TIMEOUT
		
		
		DEC ALEATORIO
		DEC ALEATORIO
		DEC ALEATORIO
		BSF LED3
		CALL TIMEOUT
		BCF LED3
		CALL TIMEOUT
		
	RAND2
		INC ALEATORIO
		INC ALEATORIO
		INC ALEATORIO
		INC ALEATORIO
		BSF LED2
		CALL TIMEOUT
		BCF LED2
		CALL TIMEOUT
		
		BSF LED6
		CALL TIMEOUT
		BCF LED6
		CALL TIMEOUT
		
		INC ALEATORIO
		INC ALEATORIO
		BSF LED5
		CALL TIMEOUT
		BCF LED5	
		CALL TIMEOUT
		
		BSF LED4
		CALL TIMEOUT
		BCF LED4
		CALL TIMEOUT
		
	RAND3
		
		DEC ALEATORIO
		DEC ALEATORIO
		DEC ALEATORIO
		DEC ALEATORIO
		BSF LED5
		CALL TIMEOUT
		BCF LED5
		CALL TIMEOUT
		
		BSF LED5
		CALL TIMEOUT
		BCF LED5
		CALL TIMEOUT
		
		INC ALEATORIO
		INC ALEATORIO
		BSF LED2
		CALL TIMEOUT
		BCF LED2	
		CALL TIMEOUT
		
		BSF LED3
		CALL TIMEOUT
		BCF LED3
		CALL TIMEOUT
		
	RAND4
		INC ALEATORIO
		INC ALEATORIO
		INC ALEATORIO
		INC ALEATORIO
		BSF LED5
		CALL TIMEOUT
		BCF LED5
		CALL TIMEOUT
		
		BSF LED1
		CALL TIMEOUT
		BCF LED1
		CALL TIMEOUT
		
		BSF LED2
		CALL TIMEOUT
		BCF LED2	
		CALL TIMEOUT
		
		BSF LED6
		CALL TIMEOUT
		BCF LED6
		CALL TIMEOUT
		
	RAND5
		INC ALEATORIO
		INC ALEATORIO
		BSF LED3
		CALL TIMEOUT
		BCF LED3
		CALL TIMEOUT
		
		BSF LED1
		CALL TIMEOUT
		BCF LED1
		CALL TIMEOUT
		
		BSF LED6
		CALL TIMEOUT
		BCF LED6	
		CALL TIMEOUT
		
		BSF LED5
		CALL TIMEOUT
		BCF LED5
		CALL TIMEOUT
		
	RAND6
	
		DEC ALEATORIO
		DEC ALEATORIO
		DEC ALEATORIO
		DEC ALEATORIO
		BSF LED3
		CALL TIMEOUT
		BCF LED3
		CALL TIMEOUT
		
		BSF LED6
		CALL TIMEOUT
		BCF LED6
		CALL TIMEOUT
		
		BSF LED1
		CALL TIMEOUT
		BCF LED1	
		CALL TIMEOUT
		
		BSF LED6
		CALL TIMEOUT
		BCF LED6
		CALL TIMEOUT
		
	RAND7
		INC ALEATORIO
		BSF LED1
		CALL TIMEOUT
		BCF LED1
		CALL TIMEOUT
		
		BSF LED6
		CALL TIMEOUT
		BCF LED6
		CALL TIMEOUT
		
		BSF LED3
		CALL TIMEOUT
		BCF LED3	
		CALL TIMEOUT
		
		DEC ALEATORIO
		DEC ALEATORIO
		DEC ALEATORIO
		DEC ALEATORIO
		BSF LED3
		CALL TIMEOUT
		BCF LED3
		CALL TIMEOUT
		
	RAND8
		BSF LED1
		CALL TIMEOUT
		BCF LED1
		CALL TIMEOUT
		
		DEC ALEATORIO
		INC ALEATORIO
		INC ALEATORIO
		DEC ALEATORIO
		DEC ALEATORIO
		DEC ALEATORIO
		BSF LED3
		CALL TIMEOUT
		BCF LED3
		CALL TIMEOUT
		
		BSF LED5
		CALL TIMEOUT
		BCF LED5	
		CALL TIMEOUT
		
		BSF LED6
		CALL TIMEOUT
		BCF LED6
		CALL TIMEOUT
		
		
	RAND9
		DEC ALEATORIO
		DEC ALEATORIO
		INC ALEATORIO
		DEC ALEATORIO
		DEC ALEATORIO
		BSF LED6
		CALL TIMEOUT
		BCF LED6
		CALL TIMEOUT
		
		BSF LED4
		CALL TIMEOUT
		BCF LED4
		CALL TIMEOUT
		
		BSF LED5
		CALL TIMEOUT
		BCF LED5	
		CALL TIMEOUT
		INC ALEATORIO
		INC ALEATORIO
		INC ALEATORIO
		INC ALEATORIO
		
		BSF LED2
		CALL TIMEOUT
		BCF LED2
		CALL TIMEOUT
		
	RAND10
		DEC ALEATORIO
		DEC ALEATORIO
		INC ALEATORIO
		INC ALEATORIO
		DEC ALEATORIO
		DEC ALEATORIO
		DEC ALEATORIO
		BSF LED5
		CALL TIMEOUT
		BCF LED5
		CALL TIMEOUT
		
		BSF LED3
		CALL TIMEOUT
		BCF LED3
		CALL TIMEOUT
		
		BSF LED2
		CALL TIMEOUT
		BCF LED2	
		CALL TIMEOUT
		
		INC ALEATORIO
		INC ALEATORIO
		BSF LED4
		CALL TIMEOUT
		BCF LED4
		CALL TIMEOUT
		INC ALEATORIO
		INC ALEATORIO
		
	GOTO GAME
	
	GAME
		GOTO ONLED
		;GOTO TESTE
		GOTO GAME

	END1
	END			;OBRIGATÓRIO


;	TESTE
;		BSF LED1
;		CALL TIMEOUT	
;
;	GOTO GAME

; 
; MOVWF B'01001010'
; MOVLW TT
; TT = TEST % 6
